---
import LayoutDefault from '~/layouts/LayoutDefault.astro'
import Post from '~/components/Post.astro'
import { getPosts, getPostDescription } from '~/utils'

const allPosts = await getPosts()
---

<LayoutDefault>
  <section un-flex="~ col gap-7.5" un-max-lg="gap-2" class="first-post-mobile">
    {
      allPosts.map((post, index) => (
        <div class="post-item">
          <Post post={post} class={index === 0 ? 'first-post' : ''}>
            <p class="line-clamp-4">{getPostDescription(post)}</p>
          </Post>
        </div>
      ))
    }
  </section>
</LayoutDefault>

<style>
  /* 避免滚动中批量插入节点导致的布局抖动，交给浏览器做按需渲染 */
  .post-item {
    content-visibility: auto;
    contain-intrinsic-size: 1px 420px;
  }
</style>
